/**
 * Created By:
 * User: lmorenojr
 */
var mediaupload=function(){var e=false,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;f=function(e){return typeof e!="undefined"&&e!==null};l=function(e){if(f(e)){e()}};c=function(){e=false;s=null;o=null;u=null;a=null;parameters=null};d=function(e){l(i);c()};g=function(e,t){var n,r,i,s;for(n=0,s=t.length;n<s;n+=1){i=t[n].name;r=t[n].fullPath;if(e){uploadVideo(r,i)}else{b(r,i)}}};v=function(e){g(false,e)};m=function(e){g(true,e)};y=function(e){var t=e.substr(e.lastIndexOf("/")+1);b(e,t)};w=function(e){if(e.lengthComputable){var t=e.loaded/e.total;if(f(u)){u(t)}}};E=function(e){if(f(o)){o(e.code)}c()};S=function(e){l(a);c()};uploadVideo=function(e,n){if(f(r)){var i=new FileUploadOptions;i.chunkedMode=false;i.fileName=n;if(f(t)){i.params=t}l(s);var u=new FileTransfer;u.onprogress=w;u.upload(e,encodeURI(r),S,E,i,true)}else{l(o);c()}};b=function(e,n){if(f(r)){n=n.toLowerCase();if(n.indexOf(".jp")==-1){n=n+".jpg"}var i=new FileUploadOptions;i.chunkedMode=false;i.fileKey="file";i.fileName=n;i.mimeType="image/jpeg";if(f(t)){i.params=t}l(s);var u=new FileTransfer;u.onprogress=w;u.upload(e,encodeURI(r),S,E,i,true)}else{l(o);c()}};h=function(){navigator.camera.getPicture(y,d,{quality:50,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,allowEdit:true})};p=function(){navigator.device.capture.captureImage(v,d,{limit:1})};getVideoFromCamera=function(e){var t={limit:1,duration:e};navigator.device.capture.captureVideo(m,d,t)};executeMediaSelection=function(n,f,d,v,m,g,y,b,w,E){if(mediaupload.isSupported()&&!e){c();e=true;r=f;i=v;s=m;o=g;u=y;a=b;t=d;if(n){if(w){getVideoFromCamera(E)}}else{if(w){p()}else{h()}}}else{l(o)}};return{isSupported:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)},ImageFromGallery:function(e,t,n,r,i,s,o){executeMediaSelection(false,e,t,n,r,i,s,o,false)},ImageFromCamera:function(e,t,n,r,i,s,o){executeMediaSelection(false,e,t,n,r,i,s,o,true)},VideoFromCamera:function(e,t,n,r,i,s,o,u){executeMediaSelection(true,e,t,n,r,i,s,o,true,u)}}}()